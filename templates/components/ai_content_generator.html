<!-- AI Content Generator Demo -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
    
    <!-- Input: Vehicle Selection -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h3 class="text-2xl font-bold mb-4">‚úçÔ∏è AI Content Generator</h3>
        <p class="text-gray-600 mb-6">Watch Claude write compelling vehicle descriptions</p>
        
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Select Vehicle</label>
                <select id="vehicle-select" class="w-full border border-gray-300 rounded-lg px-4 py-2">
                    <option value="">Loading vehicles...</option>
                </select>
            </div>
            
            <div id="vehicle-details" class="hidden bg-gray-50 rounded-lg p-4 text-sm">
                <div class="font-bold mb-2">Vehicle Details:</div>
                <div id="vehicle-info" class="space-y-1 text-gray-600"></div>
            </div>
            
            <button onclick="generateDescription()" class="w-full px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg font-bold hover:from-purple-700 hover:to-blue-700 transition">
                ü™Ñ Generate AI Description
            </button>
        </div>
    </div>
    
    <!-- Output: Generated Content -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h3 class="text-2xl font-bold mb-4">üé® Generated Content</h3>
        <div id="content-output" class="min-h-[300px] bg-gray-50 rounded-lg p-6">
            <div class="text-center text-gray-400 py-12">
                <div class="text-6xl mb-4">‚ú®</div>
                <p>Select a vehicle and click "Generate" to see AI magic!</p>
            </div>
        </div>
        
        <div id="content-actions" class="hidden mt-4 flex space-x-2">
            <button onclick="copyContent()" class="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition">
                üìã Copy
            </button>
            <button onclick="regenerateContent()" class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
                üîÑ Regenerate
            </button>
        </div>
    </div>
</div>

<script>
// Load vehicles for selection
fetch('/api/full-inventory')
    .then(response => response.json())
    .then(data => {
        const select = document.getElementById('vehicle-select');
        select.innerHTML = '<option value="">-- Select a vehicle --</option>';
        
        data.slice(0, 20).forEach(vehicle => {
            const option = document.createElement('option');
            option.value = vehicle.vin;
            option.textContent = `${vehicle.year} ${vehicle.make} ${vehicle.model} - $${vehicle.current_price.toLocaleString()}`;
            option.dataset.vehicle = JSON.stringify(vehicle);
            select.appendChild(option);
        });
    });

// Show vehicle details on selection
document.getElementById('vehicle-select').addEventListener('change', function() {
    const selected = this.options[this.selectedIndex];
    if (selected.value) {
        const vehicle = JSON.parse(selected.dataset.vehicle);
        const detailsDiv = document.getElementById('vehicle-details');
        const infoDiv = document.getElementById('vehicle-info');
        
        infoDiv.innerHTML = `
            <div><strong>Year:</strong> ${vehicle.year}</div>
            <div><strong>Make/Model:</strong> ${vehicle.make} ${vehicle.model}</div>
            <div><strong>Mileage:</strong> ${vehicle.mileage.toLocaleString()} miles</div>
            <div><strong>Price:</strong> $${vehicle.current_price.toLocaleString()}</div>
            <div><strong>Color:</strong> ${vehicle.color}</div>
            <div><strong>Condition:</strong> ${vehicle.condition}</div>
        `;
        
        detailsDiv.classList.remove('hidden');
    }
});

let currentVIN = null;
let generatedContent = null;

function generateDescription() {
    const select = document.getElementById('vehicle-select');
    const vin = select.value;
    
    if (!vin) {
        alert('Please select a vehicle first!');
        return;
    }
    
    currentVIN = vin;
    const outputDiv = document.getElementById('content-output');
    
    // Show loading state
    outputDiv.innerHTML = `
        <div class="text-center py-12">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mb-4"></div>
            <p class="text-gray-600 font-medium">Claude is writing...</p>
            <p class="text-sm text-gray-500 mt-2">Analyzing vehicle features and market positioning</p>
        </div>
    `;
    
    // Call API
    fetch(`/api/generate-description/${vin}`)
        .then(response => response.json())
        .then(data => {
            generatedContent = data.description;
            
            // Show typing animation
            typeWriter(outputDiv, generatedContent, 0, 20);
            
            // Show action buttons
            document.getElementById('content-actions').classList.remove('hidden');
        })
        .catch(error => {
            outputDiv.innerHTML = `
                <div class="text-center py-12 text-red-600">
                    <div class="text-4xl mb-4">‚ùå</div>
                    <p>Error generating content. Please try again.</p>
                </div>
            `;
        });
}

function typeWriter(element, text, index, speed) {
    if (index === 0) {
        element.innerHTML = '<div class="prose max-w-none text-gray-700"></div>';
    }
    
    const prose = element.querySelector('.prose');
    
    if (index < text.length) {
        prose.textContent += text.charAt(index);
        setTimeout(() => typeWriter(element, text, index + 1, speed), speed);
    }
}

function copyContent() {
    navigator.clipboard.writeText(generatedContent);
    
    // Visual feedback
    const btn = event.target;
    const originalText = btn.innerHTML;
    btn.innerHTML = '‚úÖ Copied!';
    setTimeout(() => {
        btn.innerHTML = originalText;
    }, 2000);
}

function regenerateContent() {
    generateDescription();
}
</script>